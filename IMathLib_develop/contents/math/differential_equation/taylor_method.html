<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<title>IMathLibリファレンス-&lt;IMathLib/differential_equation/taylor_method.hpp&gt;-</title>
<meta name="keywords" content="リファレンス" />

<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script type="text/javascript" src="../../path.js"></script>
<script>draw_path();</script>

</head>

<body onload="cpp_code_replace(); create_path();">

<script>draw_frame();</script>

<div id="main" name="main">

<header>
<p>Iroha Math Library for C++ リファレンス  [ホーム]</p>
</header>

<h4>class</h4>
<h1>iml::ode::taylor_method</h1>

<h2>概要</h2>
<p>
<code>iml::ode::taylor_method</code>はテイラー法による微分方程式の数値解析をする。<br>
なお、テンプレート引数は、第一引数は近似する次数、第二引数が独立変数の型、第三引数以降は従属変数で連立常微分方程式の戻り値兼引数型である。例えば<code>&lt;double, iml::vector3&lt;double&gt;, iml::vector3&lt;float&gt;&gt;</code>とした場合、構成される連立微分方程式は<code>iml::vector3&lt;double&gt;(double, iml::vector3&lt;double&gt;, iml::vector3&lt;float&gt;)</code>と<code>iml::vector3&lt;float&gt;(double, iml::vector3&lt;double&gt;, iml::vector3&lt;float&gt;)</code>の2つとなる。<br>
また、このクラスの実装の都合上、関数はテンプレート関数でなくてはならない。
</p>
<pre class="cpp_code"><code>
namespace iml {
	template &lt;iml::imsize_t D, class... Types&gt;
	class taylor_method;
}
</code></pre>

<h2>メンバ</h2>
<h3>構築</h3>
<table>
<thead>
<tr>
<th>名前</th>
<th>説明</th>
<th>対応バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>(constructor)</code></td>
<td>コンストラクタ</td>
<td></td>
</tr>
<tr>
<td><code>(destructor)</code></td>
<td>デストラクタ</td>
<td></td>
</tr>
</tbody>
</table>

<h3>メンバ関数</h3>
<table>
<thead>
<tr>
<th>名前</th>
<th>説明</th>
<th>対応バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>set_ini_value</code></td>
<td>初期値の設定</td>
<td></td>
</tr>
<tr>
<td><code>set_function</code></td>
<td>微分方程式のの設定</td>
<td></td>
</tr>
<tr>
<td><code>update</code></td>
<td>微分方程式の更新</td>
<td></td>
</tr>
<tr>
<td><code>reset</code></td>
<td>現在の値を初期値にする</td>
<td></td>
</tr>
<tr>
<td><code>get_ini_d_value</code></td>
<td>独立変数の初期値の取得</td>
<td></td>
</tr>
<tr>
<td><code>get_ini_l_value</code></td>
<td>従属変数の初期値の取得</td>
<td></td>
</tr>
<tr>
<td><code>get_d_value</code></td>
<td>現在の独立変数の値の取得</td>
<td></td>
</tr>
<tr>
<td><code>get_l_value</code></td>
<td>現在の従属変数の値の取得</td>
<td></td>
</tr>
<tr>
<td><code>size</code></td>
<td>変数の数の取得</td>
<td></td>
</tr>
</tbody>
</table>


<h2>実装</h2>
<p>
このクラスで実装されているテイラー法は、微分方程式を\(\frac{dy}{dx}=f(x,y)\)とし、解を\(y=F(x)\)とすれば、以下のように実装される。なお、\(h\)は差分である。
\[
\begin{align*}
F(x+h)=F(x)+\sum_{k=1}^{\infty}\frac{F^{(k)}(x)}{k!}h^{k}
\end{align*}
\]
また、\(F^{(k)}(x)\)は\(x\)で微分をすることで以下のような差分方程式が導かれる。\(F^{(0)}(x)\)は\(F(x)\)と等しいとする。<br>
\[
\begin{align*}
F^{(k+1)}(x)=\frac{\partial}{\partial x}F^{(k)}(x)+\frac{\partial}{\partial y}(F^{(k)}(x))f(x,y)
\end{align*}
\]
このクラスは理論上での常微分方程式の数値解析法の完成形なものであって、数値解析をするためにこれを用いるべきではない。上式の漸化式は微分回数が\(N\)の導関数を求めるとき、\(2\)つの\(N-1\)階の導関数を求める必要があるためである。\(N-1\)階の導関数も同様である。また、導関数は<code>iml::dual_numbers</code>によって\(N\)階の導関数を求める要領で構成されているため、非常に低速であり、計算回数が多くなるため、<code>iml::ode::runge_kutta_method</code>よりも場合によっては精度が悪くなる。
</p>

<h2>サンプルコード</h2>
<h3>入力</h3>
<pre class="cpp_code"><code>
#include &lt;IMathLib/IMathLib.hpp&gt;

template &lt;class T&gt;
T f1(const T&amp; t, const T&amp; x, const T&amp; y, const T&amp; z) { return -10 * x + 10 * y; }
template &lt;class T&gt;
T f2(const T&amp; t, const T&amp; x, const T&amp; y, const T&amp; z) { return -x*z + 28 * x - y; }
template &lt;class T&gt;
T f3(const T&amp; t, const T&amp; x, const T&amp; y, const T&amp; z) { return x*y - 8 / 3. * z; }

int main() {
	//ローレンツ方程式の定義
	iml::ode::taylor_method&lt;6, double, double, double, double&gt; ode(
		f1&lt;iml::diff_type&lt;double, 6&gt;::type&gt;, f2&lt;iml::diff_type&lt;double, 6&gt;::type&gt;, f3&lt;iml::diff_type&lt;double, 6&gt;::type&gt;
	);
	ode.set_ini_value(0, 1, 1, 1);
	ode.reset();

	for (size_t i = 0; i &lt; 100; ++i) {
		std::cout &lt;&lt; ode.get_d_value() &lt;&lt; &apos;,&apos; &lt;&lt; ode.get_l_value&lt;0&gt;()
			&lt;&lt; &apos;,&apos; &lt;&lt; ode.get_l_value&lt;1&gt;() &lt;&lt; &apos;,&apos; &lt;&lt; ode.get_l_value&lt;2&gt;() &lt;&lt; std::endl;
		//初期値鋭敏性を持つため十分に小さい値で更新する
		ode.update(1 / 60.);
	}
	
	return 0;
}
</code></pre>
<h3>出力</h3>
<pre><code><span>
0,1,1,1
0.0166667,1,1.42972,0.97284
0.0333333,1.06565,1.85279,0.953862
0.05,1.18591,2.29853,0.944586
0.0666667,1.35589,2.79084,0.947959
0.0833333,1.57512,3.35094,0.96843
0.1,1.84643,3.99928,1.01236
0.116667,2.17533,4.75677,1.0887
0.133333,2.56972,5.64571,1.21002
0.15,3.03966,6.69021,1.39386
0.166667,3.59739,7.9163,1.66469
0.183333,4.25722,9.35128,2.05643
0.2,5.03548,11.0222,2.61583
0.216667,5.95011,12.9526,3.40663
0.233333,7.01994,15.1571,4.51454
0.25,8.26311,17.6315,6.0523
0.266667,9.69439,20.3375,8.16351
0.283333,11.3204,23.1797,11.0217
0.3,13.1322,25.9732,14.819
0.316667,15.0941,28.4048,19.7334
0.333333,17.1277,29.9976,25.8628
0.35,19.0939,30.1069,33.1118
0.366667,20.7764,27.9961,41.0409
0.383333,21.8794,23.0553,48.7363
0.4,22.0591,15.1756,54.8388
0.416667,21.0074,5.13972,57.911
0.433333,18.5832,-5.33052,57.1539
0.45,14.9297,-14.1967,53.0559
0.466667,10.4798,-20.1448,47.2962
0.483333,5.80108,-23.1541,41.8005
0.5,1.37738,-24.0946,37.7951
0.516667,-2.51418,-23.9194,35.6118
0.533333,-5.78441,-23.2077,35.0443
0.55,-8.44631,-22.1507,35.709
0.566667,-10.54,-20.7084,37.2061
0.583333,-12.0935,-18.7624,39.1462
0.6,-13.1124,-16.2244,41.1427
0.616667,-13.5878,-13.108,42.8217
0.633333,-13.5145,-9.56274,43.8633
0.65,-12.9108,-5.86138,44.0632
0.666667,-11.8338,-2.33682,43.3816
0.683333,-10.3829,0.71023,41.947
0.7,-8.68809,3.09188,40.004
0.716667,-6.88837,4.76449,37.8278
0.733333,-5.10807,5.80463,35.6491
0.75,-3.44086,6.35446,33.6167
0.766667,-1.94435,6.56886,31.7995
0.783333,-0.64372,6.58239,30.2094
0.8,0.460268,6.4971,28.8276
0.816667,1.38256,6.38342,27.6236
0.833333,2.14658,6.28652,26.567
0.85,2.77907,6.23346,25.6324
0.866667,3.30683,6.23919,24.8008
0.883333,3.75483,6.31092,24.0592
0.9,4.14534,6.45117,23.3998
0.916667,4.49762,6.65972,22.8188
0.933333,4.82794,6.9348,22.3153
0.95,5.14982,7.2738,21.8911
0.966667,5.47432,7.67354,21.5502
0.983333,5.81031,8.13028,21.2983
1,6.16475,8.63947,21.1426
1.01667,6.54283,9.19538,21.0917
1.03333,6.94808,9.79045,21.1556
1.05,7.38234,10.4146,21.3448
1.06667,7.8456,11.0545,21.6702
1.08333,8.33585,11.6926,22.1418
1.1,8.84869,12.3065,22.768
1.11667,9.37696,12.8682,23.5531
1.13333,9.91035,13.3447,24.496
1.15,10.435,13.6981,25.5867
1.16667,10.9336,13.8879,26.8042
1.18333,11.3849,13.8745,28.1138
1.2,11.7653,13.6238,29.4663
1.21667,12.0492,13.1135,30.7979
1.23333,12.2118,12.3396,32.0344
1.25,12.2313,11.3213,33.098
1.26667,12.0923,10.1036,33.9163
1.28333,11.7885,8.75422,34.4334
1.3,11.3249,7.35607,34.6188
1.31667,10.7186,5.99561,34.4719
1.33333,9.997,4.74999,34.0212
1.35,9.19537,3.67661,33.3166
1.36667,8.35223,2.80784,32.4197
1.38333,7.50517,2.15132,31.393
1.4,6.68722,1.69489,30.2919
1.41667,5.9245,1.41356,29.1602
1.43333,5.23533,1.2766,28.0295
1.45,4.63052,1.25295,26.9203
1.46667,4.11451,1.31487,25.845
1.48333,3.68678,1.43969,24.81
1.5,3.34348,1.61027,23.8183
1.51667,3.07868,1.81474,22.871
1.53333,2.88558,2.04573,21.9682
1.55,2.75727,2.29959,21.1097
1.56667,2.68734,2.57558,20.2957
1.58333,2.67027,2.87521,19.5265
1.6,2.70158,3.20165,18.803
1.61667,2.77798,3.55939,18.1269
1.63333,2.89736,3.95388,17.5003
1.65,3.05877,4.39133,16.9264

</span></code></pre>

<br><br><br>

</div>

</body>


</html>
