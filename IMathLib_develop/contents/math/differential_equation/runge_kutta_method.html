<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<title>IMathLibリファレンス-&lt;IMathLib/differential_equation/runge_kutta_method.hpp&gt;-</title>
<meta name="keywords" content="リファレンス" />

<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script type="text/javascript" src="../../path.js"></script>
<script>draw_path();</script>

</head>

<body onload="cpp_code_replace(); create_path();">

<script>draw_frame();</script>

<div id="main" name="main">

<header>
<p>Iroha Math Library for C++ リファレンス  [ホーム]</p>
</header>

<h4>class</h4>
<h1>iml::ode::runge_kutta_method</h1>

<h2>概要</h2>
<p>
<code>iml::ode::runge_kutta_method</code>は4次のルンゲクッタ法による微分方程式の数値解析をする。<br>
なお、テンプレート引数は、第一引数が独立変数の型、第二引数以降は従属変数で連立常微分方程式の戻り値兼引数型である。例えば<code>&lt;double, iml::vector3&lt;double&gt;, iml::vector3&lt;float&gt;&gt;</code>とした場合、構成される連立微分方程式は<code>iml::vector3&lt;double&gt;(double, iml::vector3&lt;double&gt;, iml::vector3&lt;float&gt;)</code>と<code>iml::vector3&lt;float&gt;(double, iml::vector3&lt;double&gt;, iml::vector3&lt;float&gt;)</code>の2つとなる。
</p>
<pre class="cpp_code"><code>
namespace iml {
	template &lt;class... Types&gt;
	class runge_kutta_method;
}
</code></pre>

<h2>メンバ</h2>
<h3>構築</h3>
<table>
<thead>
<tr>
<th>名前</th>
<th>説明</th>
<th>対応バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>(constructor)</code></td>
<td>コンストラクタ</td>
<td></td>
</tr>
<tr>
<td><code>(destructor)</code></td>
<td>デストラクタ</td>
<td></td>
</tr>
</tbody>
</table>

<h3>メンバ関数</h3>
<table>
<thead>
<tr>
<th>名前</th>
<th>説明</th>
<th>対応バージョン</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>set_ini_value</code></td>
<td>初期値の設定</td>
<td></td>
</tr>
<tr>
<td><code>set_function</code></td>
<td>微分方程式のの設定</td>
<td></td>
</tr>
<tr>
<td><code>update</code></td>
<td>微分方程式の更新</td>
<td></td>
</tr>
<tr>
<td><code>reset</code></td>
<td>現在の値を初期値にする</td>
<td></td>
</tr>
<tr>
<td><code>get_ini_d_value</code></td>
<td>独立変数の初期値の取得</td>
<td></td>
</tr>
<tr>
<td><code>get_ini_l_value</code></td>
<td>従属変数の初期値の取得</td>
<td></td>
</tr>
<tr>
<td><code>get_d_value</code></td>
<td>現在の独立変数の値の取得</td>
<td></td>
</tr>
<tr>
<td><code>get_l_value</code></td>
<td>現在の従属変数の値の取得</td>
<td></td>
</tr>
<tr>
<td><code>size</code></td>
<td>変数の数の取得</td>
<td></td>
</tr>
</tbody>
</table>


<h2>実装</h2>
<p>
このクラスで実装されている4次のルンゲクッタ法は古典ルンゲクッタ法のことである。微分方程式を\(\frac{dy}{dx}=f(x,y)\)とすれば、以下のような差分方程式で近似することができる。<br>
\[
\begin{align*}
& k_1=f(x_{n},y_{n}) \\
& k_2=f(x_{n}+\frac{h}{2},y_{n}+\frac{k_1h}{2}) \\
& k_3=f(x_{n}+\frac{h}{2},y_{n}+\frac{k_2h}{2}) \\
& k_4=f(x_{n}+h,x_{n}+k_3h) \\
& y_{n+1}=y_{n}+\frac{h}{6}(k_1+2k_2+2k_3 +k_1)
\end{align*}
\]
</p>

<h2>サンプルコード</h2>
<h3>入力</h3>
<pre class="cpp_code"><code>
#include &lt;IMathLib/IMathLib.hpp&gt;

int main() {
	//ローレンツ方程式の定義
	iml::ode::euler_method&lt;double, double, double, double&gt; ode(
		[](double t, double x, double y, double z) {return -10 * x + 10 * y; }
	, [](double t, double x, double y, double z) {return -x*z + 28 * x - y; }
	, [](double t, double x, double y, double z) {return x*y - 8 / 3. * z; }
	);
	ode.set_ini_value(0, 1, 1, 1);
	ode.reset();

	for (size_t i = 0; i &lt; 100; ++i) {
		std::cout &lt;&lt; ode.get_d_value() &lt;&lt; &apos;,&apos; &lt;&lt; ode.get_l_value&lt;0&gt;()
			&lt;&lt; &apos;,&apos; &lt;&lt; ode.get_l_value&lt;1&gt;() &lt;&lt; &apos;,&apos; &lt;&lt; ode.get_l_value&lt;2&gt;() &lt;&lt; std::endl;
		//初期値鋭敏性を持つため十分に小さい値で更新する
		ode.update(1 / 60.);
	}
	
	return 0;
}
</code></pre>
<h3>出力</h3>
<pre><code><span>
0,1,1,1
0.0166667,1.03423,1.4351,0.976643
0.0333333,1.13144,1.89297,0.963471
0.05,1.28758,2.40011,0.963805
0.0666667,1.50314,2.98165,0.982984
0.0833333,1.78243,3.66305,1.02906
0.1,2.1331,4.47135,1.1139
0.116667,2.56596,5.43592,1.2549
0.133333,3.09488,6.58877,1.47735
0.15,3.73668,7.96394,1.81775
0.166667,4.51086,9.59539,2.32826
0.183333,5.43886,11.5124,3.08219
0.2,6.54242,13.7309,4.18016
0.216667,7.84038,16.2383,5.75511
0.233333,9.34298,18.9698,7.9723
0.25,11.0427,21.775,11.0166
0.266667,12.9007,24.3801,15.0548
0.283333,14.8308,26.3639,20.1613
0.3,16.6844,27.1833,26.2053
0.316667,18.2506,26.2949,32.7401
0.333333,19.2817,23.3834,38.9836
0.35,19.5545,18.6034,43.9932
0.366667,18.9474,12.6475,47.0184
0.383333,17.4925,6.5173,47.8267
0.4,15.3683,1.11884,46.7587
0.416667,12.8359,-3.03638,44.4902
0.433333,10.1598,-5.86842,41.7108
0.45,7.55186,-7.57842,38.9228
0.466667,5.15032,-8.46855,36.4008
0.483333,3.02625,-8.82411,34.2455
0.5,1.20078,-8.86621,32.456
0.516667,-0.336653,-8.74766,30.9869
0.533333,-1.61393,-8.56628,29.7808
0.55,-2.66641,-8.38099,28.7844
0.566667,-3.53088,-8.22515,27.9545
0.583333,-4.24225,-8.11597,27.2584
0.6,-4.83186,-8.06074,26.6727
0.616667,-5.32684,-8.06078,26.1815
0.633333,-5.75007,-8.11376,25.774
0.65,-6.12035,-8.21521,25.444
0.666667,-6.4528,-8.35927,25.1875
0.683333,-6.75925,-8.53914,25.0027
0.7,-7.04861,-8.74734,24.8888
0.716667,-7.32721,-8.97574,24.8455
0.733333,-7.59912,-9.21559,24.8724
0.75,-7.8664,-9.45759,24.9685
0.766667,-8.12932,-9.69188,25.132
0.783333,-8.38656,-9.90824,25.3594
0.8,-8.63543,-10.0963,25.6456
0.816667,-8.87207,-10.2461,25.9832
0.833333,-9.09174,-10.3483,26.3625
0.85,-9.28909,-10.3951,26.7717
0.866667,-9.45855,-10.3807,27.1966
0.883333,-9.59473,-10.3019,27.6217
0.9,-9.69281,-10.1589,28.0306
0.916667,-9.74902,-9.95513,28.407
0.933333,-9.76098,-9.6976,28.7358
0.95,-9.72796,-9.39621,29.0041
0.966667,-9.65108,-9.06319,29.2018
0.983333,-9.53327,-8.71217,29.3225
1,-9.37917,-8.35716,29.3636
1.01667,-9.19481,-8.01156,29.3261
1.03333,-8.98724,-7.68736,29.2142
1.05,-8.76413,-7.39452,29.0349
1.06667,-8.53331,-7.14071,28.7967
1.08333,-8.30241,-6.93127,28.5097
1.1,-8.07852,-6.76933,28.1843
1.11667,-7.86798,-6.65616,27.8308
1.13333,-7.67624,-6.59156,27.4594
1.15,-7.50776,-6.57419,27.0796
1.16667,-7.36607,-6.60196,26.7004
1.18333,-7.25378,-6.67231,26.3299
1.2,-7.17271,-6.78239,25.9757
1.21667,-7.12392,-6.9292,25.6448
1.23333,-7.10785,-7.10963,25.3437
1.25,-7.12439,-7.32046,25.0785
1.26667,-7.17293,-7.55823,24.8548
1.28333,-7.2524,-7.81921,24.678
1.3,-7.36129,-8.09917,24.553
1.31667,-7.49762,-8.39332,24.4842
1.33333,-7.65894,-8.69606,24.4754
1.35,-7.84223,-9.00095,24.5295
1.36667,-8.04387,-9.3006,24.6483
1.38333,-8.2596,-9.58668,24.8322
1.4,-8.48446,-9.85004,25.0796
1.41667,-8.7128,-10.081,25.387
1.43333,-8.93832,-10.2696,25.7483
1.45,-9.15422,-10.4065,26.1547
1.46667,-9.35334,-10.4833,26.5946
1.48333,-9.52849,-10.4935,27.0541
1.5,-9.67279,-10.4332,27.5171
1.51667,-9.78005,-10.3018,27.9661
1.53333,-9.84526,-10.1025,28.3838
1.55,-9.86492,-9.84201,28.7532
1.56667,-9.83741,-9.53067,29.0598
1.58333,-9.76317,-9.18149,29.2921
1.6,-9.6447,-8.80924,29.4422
1.61667,-9.48647,-8.42932,29.5066
1.63333,-9.2946,-8.05664,29.4857
1.65,-9.07644,-7.70463,29.3837

</span></code></pre>

<br><br><br>

</div>

</body>


</html>
